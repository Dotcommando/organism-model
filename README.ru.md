# Organism Model XML (OMXML)

> This README is available in other languages:
> - [English](README.md)

## Цель проекта

Цель проекта - создать формат XML, позволяющий описывать биологические организмы на разных уровнях. Уровни, которыми оперирует схема: Системы (опорно-двигательная, пищеварительная, нервная и т.п.), Органы, Клетки, Органеллы. Необязательно описывать организм на уровне органелл клеток. Для минимального использования достаточно описать организм на уровне систем. Если вы хотите имитировать эволюцию с упором на какие-то определённые органы, вы можете описать им на уровне клеток, а все остальные системы оставить на уровне Систем организма. При имитации эволюции на компьютере OMXML код выполняет роль аминокислот и белков.

Более того, вы можете начать эволюцию с организмами, описанными на уровне Систем, а затем, можете вмешаться и детализировать ту или иную систему до набора органов или даже до клеток. Т.е. когда вид стабилизируется и подавляющее большинство особей станет жизнеспособными, вы сможете сфокусировать свой взгляд на определённой Системе организма и детализировать её. Детализированные до органов или клеток Системы организма будут производить/запасать/транспортировать то же количество гормонов/веществ, что и Система до момента вмешательства. Вы просто сэкономите этим процессорное время. Планета будет багодарна вам )

## Геном

Organism Model XML не включает в себя гены. Подразумевается, что вы сами написали систему кодирования, которая имитирует гены, а продуктом исполнения генома на компьютере являются документы в формате Organism Model XML.

## Химия

Описание организма подразумевает минимальное описание базовых химических компонентов мира. Химические реакции между этими компонентами должны быть описаны вне документа OMXML, т.к. реакции не имеют отношения к организму. Пример описания базовых химических компонентов мира:

```xml
    <Resources>
        <!-- Simple resources -->
        <resource name="lightEnergy" type="simple"/>
        <resource name="oxygen" type="simple"/>
        <resource name="carbon" type="simple"/>
        <resource name="nitrogen" type="simple"/>
        <resource name="phosphorus" type="simple"/>
        <resource name="potassium" type="simple"/>
        <resource name="water" type="simple"/>

        <!-- Complex resources -->
        <resource name="carbonDioxide" type="complex"/>
        <resource name="glucose" type="complex"/>
        <resource name="ATP" type="complex"/>
        <resource name="livingPlantOrganic" type="complex"/>
        <resource name="deadPlantOrganic" type="complex"/>
        <resource name="livingAnimalOrganic" type="complex"/>
        <resource name="deadAnimalOrganic" type="complex"/>
        <resource name="excrement" type="complex"/>
    </Resources>
```

## Принципы OMXML

1. Документ является одновременно и описанием вида и особью с конкретными характеристиками, подобно тому, как тело животного имеет белки, характерные для всего вида, так и отдельные анатомические особенности, которые выделяют особь из популяции.
2. Понятие слоя. Организм может быть описан на любом уровне: Организм, Система, Орган, Клетка, Органелла. Но если исследователь решил описать клетки какого-то органа, то должны быть описаны все слои выше. Т.е. если исследователь описывает органеллы, то должна быть клетка, составной частью которой она является, орган, система и, наконец, организм.
3. Понятие сущности. Каждый слой состоит из сущностей. Например, у слоя организма только одна сущность - сам организм. При это в одном документе может описываться несколько организмов, это необходимо для возможности описания феноменов деления одноклеточных, беременности, симбионтов и заражения паразитом. На уровне систем сущностями являются каждая система. На уровне органов - каждый орган. Когда говорим "сущности организма" имеем ввиду все сущности каждого слоя. Это в одно и то же время могут быть и органеллы, и клетки, и органы, и системы. 
4. Произвольное выделение сущностей. Какая-то система может быть детализирована до слоя Органелл, это не значит, что остальные системы должны быть описаны до этого же слоя. Напротив, остальные сущности могут вообще быть не описанными. Их функциями (не описанных систем) можно наделить Организм в целом.
5. Не указываем числом основные характеристики напрямую. Например, мы не пишем, что сила мускула является, например, "10". Вместо этого мы пишем сколько ресурсов потребляет и выделяет этот мускул и сколько ресурсов потребляет и выделяет в целом организм. Система мира, который содержит этот организм, рассчитывает силу в каждый момент времени основываясь на химии мира, на том, сколько ресурсов доставляет кровеноская система до мускула и сколько отходов успевает убрать лимфатическая система. Если таковых систем нет, а другие системы/органы/клетки/органеллы тоже потребляют и выделяют какие-то вещества и при этом суммарно оказывается, что все органы/клетки/системы недополучают питательных веществ и отходы не успевают быть убранными, то штрафы распределяются на сущности организма по правилам мира.
6. Каждая сущность должна содержать какое-то количество вещества (элемент &lt;composition&gt;). Это нужно для двух целей. Чтобы вещество в мире не убывало и не прибывало в процессе жизнедеятельности организма, а лишь преобразовывалось из одной формы в другую посредством химии мира с выделением и поглощением энергии. Вторая цель - точно рассчитать какое количество вещества нужно вернуть в мир в случае смерти особи.
7. Т.к. формат OMXML не описывает геном, а только лишь прикладной уровень организма, естественно, что XML, который будет создаваться внешней системой ДНК чаще всего будет невалидным по стандарту OMXML. Это считается нормальным и отражает реальное положение дел в эволюции, когда природа идёт не всегда самым оптимальным путём. Т.к. документ будет парсится системой мира, то полагается, что система мира способна будет способна прочесть невалидный OMXML документ, выполнив то из него, что сумеет пронять, подобно браузеру, который отобразит любой HTML документ, даже невалидный.

## Сценарии использования

Вы хотели бы попробовать исследовать те или иные ветки эволюции. Вам нужны ответы на вопросы "А что, если ...".

- А что если полов было бы 3?
- А что если бы генокрады из Warhammer 40000 существовали бы?
- Как по численности популяция двухполых хищников будет отличаться от популяции трёхполых?


## Почему не JSON

Одним из преимуществ XML, которого нет у JSON формата, возможность отображать даже невалидные документы. Эволюция далеко не всегда выбирает самые оптимальные пути. Часто случается так, что какой-то фрагмент ДНК кодирует белок, который никак не влияет на развитие организма. Соответственно, XML-документ может быть не валидным, но при этом описывать жизнеспособный организм.

Вот этот код будет отображён браузером, хоть он и не валиден:

```XML
<sexes>
    <sex id="sex_female" name="Female">
        <sexualOrganRef id="org_femaleSex"/>
    </sex>
    <sex id="sex_primaMale" name="Prima-male">
        <sexualOrganRef id="org_primaMaleSex"/>
    </sex>
    <sex id="sex_secundaMale" name="Secunda-male">
        <sexualOrganRef id="org_secundaMaleSex"/>
    </sex>
    <<!<not valid code/>>
</sexes>
```

А вот JSON не может быть прочитан стандартными средствами, если какой-то участок его не валиден, более того, очень сложно (_но возможно_) создать парсер, который будет пытаться отделить валидную часть от невалидной:

```json
{
    "sexes": {
        "sex": [
            {
                "id": "sex_female",
                "name": "Female",
                "sexualOrganRef": {
                    "id": "org_femaleSex"
                }
            },
            {
                "id": "sex_primaMale",
                "name": "Prima-male",
                "sexualOrganRef": {
                    "id": "org_primaMaleSex"
                }
            },
            {
                "id": "sex_secundaMale",
                "name": "Secunda-male",
                "sexualOrganRef": {
                    "id": "org_secundaMaleSex"
                }
            }
        ],
        "not valid: code,
    }
]
    }
}
```

## Использование

Подразумевается, что вы имеете компилятор ДНК, который превращает OMXML код в ваш формат ДНК и обратно, ДНК в формат OMXML. Сначала вы описываете организм в формате OMXML. Затем, при помощи своего компилятора ДНК вы кодируете начальный организм. Т.к. документ в формате OMXML описывает отдельную особь, то ваш компилятор должен иметь возможность разметки определённых участков, где кодируются конкретные числа, как случайных чисел в заданном диапазоне. Это нужно, чтобы начальная популяция имела некий разброс характеристик, потому что может оказаться, что именно та особь, которую вы создали изначально, не жизнеспособна в условиях вашего мира.

После этого у вас есть ДНК, которое может сгенерировать начальную популяцию. Отсюда вы можете начать исследование нового мира с новыми существами.

## Дорожная карта

- 0.2.0 - 0.3.0: возможность работать с метаболизмом нового организма (организмами) в случае беременности или заражения паразитом.
- 0.3.0 - 0.4.0: взаимодействие между системами, представление которых работает на уровне систем, и системами, представление которых работает на уровне органов.
- ???: пока планы не заходят так далеко.

## Лицензия

Этот проект лицензирован под [MIT License](https://opensource.org/licenses/MIT).

## Предложения

Предложения по доработке формата принимаются в Telegram @bravored и по email webestet@gmail.com.
